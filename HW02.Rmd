---
title: "Homework 02 - STAT440"
author: "Joseph Sepich (jps6444)"
date: "09/04/2020"
output:
  pdf_document:
    number_sections: false
---

# Problem 1

Which of the following is an appropriate variable name?

* (a) 1st_var
* (b) first_var
* (c) first.var

**first_var or choice b** is the appropriate variables name of the three choices. Variables cannot start with a number and using a dot in the variable name can be confused with function syntax.

# Problem 2

Recall that if $x := (x_1,...,x_d) \in R^d$, then the euclidean norm of $x$ is $||x||_2 = \sqrt{\Sigma_{i=1}^dx_i^2}$. Let

$$
V = [v_1, v_2, v_3, v_4, v_5] = \begin{array}{|c c c c c|}
1 & 2 & 4 & -1 & 0\\
2 & 1 & -4 & 1 & 3\\
3 & 0 & 1 & -1 & 5
\end{array}
$$
Create matrix V in R:

```{r}
mat_v <- matrix(c(1, 2, 3, 2, 1, 0, 4, -4, 1, -1, 1, -1, 0, 3, 5), nrow = 3, ncol=5)
mat_v
```

Use R to do the following

## 2a

Create a matrix $D$ made out of the norm of all pairwise distances of the column vectors of V. That is, the $ij^{th}$ entry of $D$ is $||v_i - v_j||_2$.

```{r}
l2_norm <- function(vec) {
  sqrt(sum(vec^2))
}

num_cols <- dim(mat_v)[2]
mat_d <- matrix(1:25, nrow = num_cols, ncol = num_cols)
for (i in 1:num_cols) {
  for (j in 1:num_cols) {
    mat_d[i, j] <- l2_norm(mat_v[,i] - mat_v[,j])
  }
}
mat_d
```

## 2b

Use $D$ to compute the average and standard deviation of these distances. Be careful not to double count.

```{r}
dists <- mat_d[upper.tri(mat_d,diag=TRUE)]
print('Average:')
print(mean(dists))
print('Standard Dev:')
print(sd(dists))
```

## 2c

Find vectors $y_j$ so that the $j^{th}$ of $D_{y_j}$ is the average distance from $v_j$ to all other points. Report these numbers.

# Problem 3

## 3a

Build a simple linear regression function using ordinary least squares that takes two inputs $x$ and $y$, fits $y$ to $x$, and returns the slope and intercept. Use it to fit the **iron** column to the **calcium** column in the **nutrient** dataset.

```{r}
ols_regress <- function(x, y) {
  slope_numerator <- cov(x, y)
  slope_denom <- var(x)
  slope <- slope_numerator / slope_denom
  inter <- mean(y) - slope * mean(x)
  return(list("slope" = slope, "intercept" = inter))
}
```

```{r}
# load dataset
nutrient_df <- read.csv('./data/nutrient.csv')

# perform regression
model <- ols_regress(nutrient_df$calc, nutrient_df$iron)
print('Slope:')
print(model$slope)
print('Intercept:')
print(model$intercept)
```

## 3b

Learn how to use the R function **lm** and use it to fit iron to calcium. Use the **summary** function on the output of **lm** and compare it to the output of your function in (a).

```{r}
model <- lm(iron~calc,data=nutrient_df)
summary(model)
```

The output of the lm function regression of fitting **iron** to **calcium** has the same estimate for the intercept and slope.
